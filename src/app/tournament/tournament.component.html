<p-confirmDialog header="Confirmation" icon="fa fa-question-circle" width="425"></p-confirmDialog>

<p-dialog [(visible)]="orgaDialogVisibility"
          [contentStyle]="{'overflow':'visible', 'height':'100%'}"
          [modal]=true
          [width]="400"
          [height]="200">
  <p-header>
    Organizer password required
  </p-header>
  <form [formGroup]="orgaForm" (ngSubmit)="checkIfPasswordCorrect()" novalidate>
    <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid">
        <div class="ui-grid-row">
          <div class="ui-grid-col-4">
            Orga:
          </div>
          <div class="ui-grid-col-8">
            <input formControlName="user"  id="user" name="user"
                   tabindex="1" type="text" pInputText value="Orga">
          </div>
        </div>
      <div class="ui-grid-row">
        <div class="ui-grid-col-4">
          Password:
        </div>
        <div class="ui-grid-col-8">
          <input id="password" name="password"
                 #orgaPasswordField
                 type="password"
                 (keyup.enter)="checkIfPasswordCorrect()"
                 tabindex="2"  pPassword
                 formControlName="password"
                 required>
        </div>
      </div>
      <div class="ui-grid-row"
           *ngIf="passwordWrong">
        <div class="ui-grid-col-12">
          <div class="ui-message ui-messages-error ui-corner-all">
            Password wrong
          </div>
        </div>
      </div>
      <div class="ui-grid-row bottom-button">
        <div class="ui-grid-col-12">
          <button [disabled]="orgaForm.pristine"
                  tabindex="2" pButton type="submit" class="full-width" label="Orga access"></button>
        </div>
      </div>
    </div>
  </form>
</p-dialog>


<p-dialog [(visible)]="pairRoundDialogVisibility"
          [contentStyle]="{'overflow':'visible', 'height':'100%'}"
          [modal]=true
          [width]="400">
  <p-header>
    Pair Round {{roundToPair}}
  </p-header>
  <div class="ui-grid ui-grid-responsive ui-grid-pad ui-fluid">

    <div class="ui-grid-row" *ngIf="failedToCreateRound">
      <div class="ui-grid-col-12 big-text fail-color">
        Failed to create Round. Check Restrictions.
      </div>
    </div>

    <div class="ui-grid-row">
      <div class="ui-grid-col-8">
        Location Restriction*:
      </div>
      <div class="ui-grid-col-8">
        <p-inputSwitch [(ngModel)]="locationRestriction"></p-inputSwitch>
      </div>
    </div>
    <div class="ui-grid-row">
      <div class="ui-grid-col-12 small-text">
        * No pairings will be generated with given Restriction. If no pairing is possible
        you can just uncheck the option and try again
      </div>
    </div>
  </div>
  <p-footer>
    <button *ngIf="tournament?.actualRound == 0 && !sameRoundAgain"
            type="button"
            pButton
            icon="fa-check"
            (click)="createFirstRound()"
            label="Start Tournament">
    </button>
    <button *ngIf="tournament?.actualRound > 0 && !sameRoundAgain"
            type="button"
            pButton
            icon="fa-check"
            (click)="nextRound()"
            label="Next Round">
    </button>
    <button *ngIf="sameRoundAgain"
            type="button"
            pButton
            icon="fa-check"
            (click)="pairAgain()"
            label="Pair Again">
    </button>
    <button type="button" pButton icon="fa-close" (click)="pairRoundDialogVisibility = false" label="Cancel"></button>
  </p-footer>
</p-dialog>

<ng-container *ngIf="(loadingTournament)">
  <div class="heading">Load Tournament...</div>
  <div class="centered-content-container">
    <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
  </div>
</ng-container>

<ng-container *ngIf="(!loadingTournament)">
  <p-panel [style]="{'text-align':'center'}"
           header="{{tournament?.name}} - {{tournament?.type?.toUpperCase()}} Tournament - ActualRound {{tournament?.actualRound}}"
           [toggleable]="true">
    <div *ngIf="isOrga" class="sub-heading">Hello Organizer</div>

    <div class="centered-content-container">
      <button *ngIf="(shownRound > 0)" pButton label="Previous Round" (click)="showPreviousRound()" class="ui-button-info"></button>
      <button *ngIf="!isOrga" pButton label="Orga View" (click)="showOrgaDialog()" class="ui-button-success"></button>
      <button *ngIf="(shownRound < tournament?.actualRound)" pButton label="Next Round" (click)="showNextRound()" class="ui-button-info"></button>
      <button *ngIf="(shownRound === tournament?.actualRound) && (tournamentFinished)" pButton label="Final Standings" (click)="showNextRound()" class="ui-button-info"></button>
     </div>
  </p-panel>

  <p-panel *ngIf="participantsModified">
    <p-header>
      <span class="ui-panel-title save-mod-heading">Players modified. Please save to publish</span>
      <button pButton type="button" class="ui-button-success save-mod-button"
              (click)="saveParticipants()" label="Save" icon="fa-check"></button>
    </p-header>
  </p-panel>

  <p-panel *ngIf="isOrga" header="Orga Area" [toggleable]="true">

    <ng-container *ngIf="(startingTournament)">
      <div class="heading">Start Tournament...</div>
      <div class="centered-content-container">
        <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
      </div>
    </ng-container>
    <ng-container *ngIf="(deletingRound)">
      <div class="heading">Delete Round...</div>
      <div class="centered-content-container">
        <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
      </div>
    </ng-container>
    <ng-container *ngIf="(updateParticipantList)">
      <div class="heading">Update PlayerList...</div>
      <div class="centered-content-container">
        <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
      </div>
    </ng-container>

    <ng-container *ngIf="(updateMatchList)">
      <div class="heading">Update MatchList...</div>
      <div class="centered-content-container">
        <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
      </div>
    </ng-container>

    <ng-container *ngIf="(swappingPlayer)">
      <div class="heading">Swapping...</div>
      <div class="centered-content-container">
        <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
      </div>
    </ng-container>

    <ng-container *ngIf="(pairingAgain)">
      <div class="heading">Pair Round Again...</div>
      <div class="centered-content-container">
        <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
      </div>
    </ng-container>

    <ng-container *ngIf="(creatingNextRound)">
      <div class="heading">Create next Round...</div>
      <div class="centered-content-container">
        <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
      </div>
    </ng-container>

    <ng-container *ngIf="(loadingPlayers)">
      <div class="heading">Load available Players...</div>
      <div class="centered-content-container">
        <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
      </div>
    </ng-container>

    <div *ngIf="(!loadingPlayers) && (!loadingParticipants) && tournament?.actualRound === 0 && possiblePlayersToAdd?.length === 0" class="sub-heading">
      <i class="fa fa-arrow-left fa-2x" aria-hidden="true"></i> No possible Players found. Please add new players with
      GameSystem {{tournament?.gameSystem}} in sidebar *NEW PLAYER*
    </div>
    <div class="orga-panel-container"
         *ngIf="(!loadingPlayers) && tournament?.actualRound === 0 && possiblePlayersToAdd?.length > 0 ">
      <p-dataTable [value]="possiblePlayersToAdd"
                   [paginator]="true"
                   [pageLinks]="3"
                   [rows]="5">
        <p-header>List of Players</p-header>
        <p-column field="name"
                  header="Name"
                  [sortable]="true"
                  [filter]="true"
                  filterPlaceholder="Search">
        </p-column>
        <p-column field="location"
                  header="Location"
                  [sortable]="true"
                  [filter]="true"
                  filterPlaceholder="Search">
        </p-column>
        <p-column styleClass="col-actions">
          <ng-template pTemplate="header">
            Actions
          </ng-template>
          <ng-template let-player="rowData" pTemplate="body">
            <button type="button" pButton (click)="addParticipant(player)" icon="fa-plus" label="Add Player"></button>
          </ng-template>
        </p-column>
      </p-dataTable>
    </div>
    <div class="orga-panel-container">
      <button *ngIf="tournament?.actualRound === 0 && participants?.length >= 2 && (!loadingPlayers) && !participantsModified"
              pButton type="button"
              class="action-element ui-button-success"
              (click)="pairRound(false)"
              label="Start Tournament">
      </button>
      <button *ngIf="tournament?.actualRound > 0 && allMatchesFinished && !tournamentFinished"
              pButton type="button"
              class="action-element ui-button-success"
              (click)="pairRound(false)"
              label="Next Round">
      </button>
      <button *ngIf="tournament?.actualRound > 0 && allMatchesFinished && !tournamentFinished"
              pButton type="button"
              class="action-element ui-button-success"
              (click)="finishTournament()"
              label="Finish Tournament">
      </button>
      <button *ngIf="tournamentFinished"
              pButton type="button"
              class="action-element ui-button-success"
              (click)="undoFinishTournament()"
              label="Undo Finish Tournament">
      </button>
      <button *ngIf="tournament?.actualRound > 0 && noMatchFinished"
              pButton type="button"
              class="action-element ui-button-success"
              (click)="pairRound(true)"
              label="Pair again">
      </button>
      <button *ngIf="tournament?.actualRound !== tournament?.publishedRound"
              pButton type="button"
              class="action-element ui-button-success"
              (click)="publishRound()"
              label="Publish Round">
      </button>
      <button *ngIf="tournament?.actualRound > 0 && !tournamentFinished"
              pButton type="button"
              (click)="deleteRound()"
              class="action-element ui-button-warning"
              label="Delete Round">
      </button>
    </div>
  </p-panel>
  <p-panel header="{{getPlayerTableHeading()}}" [toggleable]="true"
           [collapsed]="!(shownRound === 0 || shownRound > tournament?.actualRound)">

    <ng-container *ngIf="(loadingParticipants)">
      <div class="heading">Load Participants...</div>
      <div class="centered-content-container">
        <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
      </div>
    </ng-container>

    <button pButton type="button" (click)="stackedPlayers = !stackedPlayers" label="Toggle" icon="fa-list"></button>
    <button pButton type="button" (click)="exportStandings()" label="Export" icon="fa-download"></button>
    <p-dataTable *ngIf="(!loadingParticipants) && (!startingTournament)"
                 [value]="participants"
                 [editable]="isOrga"
                 [stacked]="stackedPlayers"
                 (onEditComplete)="onEditParticipant($event)"
                 [responsive]="true"
                 [rows]="10"
                 [paginator]="true"
                 [pageLinks]="3"
                 [rowsPerPageOptions]="[5, 10, 20, 50, 100, 300]"
                 [exportFilename]="'Standings Round: ' + shownRound"
                 #standingsTable>
      <p-header>{{participants?.length}} Players in Tournament</p-header>

      <p-column field="name"
                header="Name"
                [sortable]="true"
                [filter]="true"
                styleClass="break-word"
                filterPlaceholder="Search">
      </p-column>
      <p-column [editable]="isOrga && tournament?.actualRound === 0"
                styleClass="{{isOrga && tournament?.actualRound === 0 ? 'editable-column' : ''}}, break-word"
                field="location"
                header="Location"
                [sortable]="true"
                [filter]="true"
                filterPlaceholder="Search">
      </p-column>

      <ng-container *ngFor="let participantField of gameSystemConfig.participantFields">
        <p-column [editable]="isOrga && tournament?.actualRound === 0"
                  styleClass="{{isOrga && tournament?.actualRound === 0 ? 'editable-column' : ''}}, break-word"
                  field="{{participantField.field}}"
                  header="{{participantField.field}}"
                  [sortable]="true"
                  [filter]="true"
                  filterPlaceholder="Search">
          <ng-template let-col let-participant="rowData" pTemplate="editor">
            <p-dropdown *ngIf="participantField.type === 'dropDown'"
                        placeholder="None"
                        [(ngModel)]="participant[col.field]"
                        [options]="participantField.fieldValues"
                        (onChange)="changeParticipant(participant)"
                        (onBlur)="updateParticipant()"
                        [autoWidth]="false"
                        [style]="{'width':'100%'}">
            </p-dropdown>
            <p-multiSelect *ngIf="participantField.type === 'multiSelect'"
                           placeholder="None"
                           [(ngModel)]="participant[col.field]"
                           [options]="participantField.fieldValues"
                           (onChange)="changeParticipant(participant)"
                           (onPanelHide)="updateParticipant()"
                           [showToggleAll]=false
                           [maxSelectedLabels]=3
                           [style]="{'width':'100%'}">
            </p-multiSelect>
          </ng-template>
        </p-column>
      </ng-container>

      <p-column sortable="custom"
                header="Score"
                (sortFunction)="sortByScore($event)">
        <ng-template let-participant="rowData" pTemplate="body">
          {{getActualScore(participant)}} <i class="fa fa-info-circle" pTooltip="{{getScoreTooltip(participant)}}"></i>
        </ng-template>
      </p-column>

      <ng-container *ngFor="let scoreField of gameSystemConfig.standingFields">
        <p-column header="{{scoreField.field}}">
          <ng-template let-participant="rowData" pTemplate="body">
            {{getScoreFieldValue(scoreField, participant)}}
            <i class="fa fa-info-circle" pTooltip="{{getScoreFieldValueTooltip(scoreField, participant)}}"></i>
          </ng-template>
        </p-column>
      </ng-container>

      <p-column styleClass="col-actions" *ngIf="tournament?.actualRound === 0">
        <ng-template pTemplate="header">
          Actions
        </ng-template>
        <ng-template let-participant="rowData" pTemplate="body">
          <button *ngIf="isOrga"
                  type="button" pButton (click)="deleteParticipant(participant)" icon="fa-trash" label="Remove Player">
          </button>
        </ng-template>
      </p-column>
    </p-dataTable>
  </p-panel>

  <p-panel *ngIf="matchModified">
    <p-header>
      <span class="ui-panel-title save-mod-heading">Games modified. Please save to publish</span>
      <button pButton type="button" class="ui-button-success save-mod-button"
              (click)="saveMatches()" label="Save" icon="fa-check"></button>
    </p-header>
  </p-panel>

  <ng-container *ngIf="!(shownRound > tournament?.actualRound)">
    <p-panel *ngIf="shownRound > 0 &&
                    !isOrga && tournament?.actualRound !== tournament?.publishedRound && shownRound >= tournament?.actualRound"
             class="heading"
             header="TO is pairing. Round will be visible when new round is published.">
    </p-panel>
      <p-panel *ngIf="shownRound > 0 &&
                    (isOrga || tournament?.actualRound === tournament?.publishedRound || shownRound < tournament?.actualRound)"
             header="Pairings Round {{shownRound}}" [toggleable]="true">

      <ng-container *ngIf="(loadingRound || roundMatches?.length === 0)">
        <div class="heading">Load Round...</div>
        <div class="centered-content-container">
          <i class="fa fa-spinner fa-pulse fa-3x fa-fw"></i>
        </div>
      </ng-container>

      <button pButton type="button" (click)="stackedMatches = !stackedMatches" label="Toggle" icon="fa-list"></button>
      <button pButton type="button" (click)="exportMatches()" label="Export" icon="fa-download"></button>
      <p-dataTable
        *ngIf="(!loadingParticipants) &&
               (!loadingRound) &&
               (!startingTournament) &&
               (!deletingRound) &&
               (!clearingMatch) &&
               (!pairingAgain) &&
               (!creatingNextRound) &&
               (!swappingPlayer)"
        [value]="roundMatches"
        [editable]="isOrga"
        (onEditComplete)="onEditMatch($event)"
        [responsive]="true"
        [rowStyleClass]="getStyleForMatchesRow"
        [rows]="20"
        [paginator]="true"
        [pageLinks]="3"
        [dataKey]="'id'"
        [immutable]="true"
        [stacked]="stackedMatches"
        [rowsPerPageOptions]="[5, 10, 20, 50, 100, 300]"
        [csvSeparator]="';'"
        [exportFilename]="'Matches_Round_' + shownRound"
        #matchesTable>
        <p-header>{{roundMatches?.length}} Matches</p-header>
        <p-column styleClass="col-result" *ngIf="isOrga">
          <ng-template pTemplate="header">Result</ng-template>
          <ng-template pTemplate="body" let-roundMatch="rowData">
            <div style="text-align: center">
              <p-dropdown
                [autoWidth]="false"
                [style]="{'width':'100%'}"
                placeholder="Undone"
                [(ngModel)]="roundMatch['result']"
                [options]="winningOptions"
                (onChange)="changeWinner($event, roundMatch)">
              </p-dropdown>
            </div>
            <div *ngIf="roundMatch?.finished" style="text-align: center">
              <i class="fa fa-times warning-icon"
                 aria-hidden="true"
                 (click)="clearMatch(roundMatch)"> Clear Game</i>
            </div>
          </ng-template>
        </p-column>
        <p-column field="table"
                  header="Table"
                  [editable]="isOrga"
                  [sortable]="true"
                  [filter]="true"
                  styleClass="col-table"
                  filterPlaceholder="Search">
        </p-column>
        <p-column styleClass="col-player col-firstPlayer"
                  field="participantOne.name"
                  header="Player 1"
                  [sortable]="true"
                  [filter]="true"
                  filterPlaceholder="Search">
          <ng-template pTemplate="filter" let-col let-roundMatch="rowData">
            <input type="text"
                   [(ngModel)]="participantOneFilter"
                   pInputText
                   class="ui-column-filter"
                   (keyup)="filterParticipantOneMatchesTable()"/>
          </ng-template>
          <ng-template pTemplate="body" let-roundMatch="rowData">
            <div style="text-align: center"
                 pTooltip="{{getToolTipForSwap(roundMatch, roundMatch.participantOne, roundMatch.participantTwo)}}"
                 (click)="dropPlayer(roundMatch, roundMatch.participantOne, roundMatch.participantTwo, 'one')"
                 [ngClass]="{
                     'swappable-player': (playerToSwap && checkSwap(roundMatch, roundMatch.participantOne, roundMatch.participantTwo) === 'swap'),
                     'not-intended-to-swap-player': (playerToSwap && checkSwap(roundMatch, roundMatch.participantOne, roundMatch.participantTwo) === 'not'),
                     'impossible-to-swap-player': (playerToSwap && checkSwap(roundMatch, roundMatch.participantOne, roundMatch.participantTwo) === 'impo'),
                     'winner-label': (roundMatch.scoreParticipantOne === 1 && roundMatch.finished),
                     'looser-label': (roundMatch.scoreParticipantTwo === 1 && roundMatch.finished),
                     'draw-label': (roundMatch.scoreParticipantOne === roundMatch.scoreParticipantTwo && roundMatch.finished)
                  }">
              <span class="very-big-text break-word" *ngIf="roundMatch.participantOne.name !== 'bye'">
                ({{getScoreTillRoundForParticipant(roundMatch.participantOne)}})
                {{roundMatch.participantOne.name}}
              </span>
              <span class="very-big-text" *ngIf="roundMatch.participantOne.name === 'bye'">BYE</span>
              <i *ngIf="!roundMatch?.finished && isOrga && !playerToSwap && !tournamentFinished"
                 class="fa fa-arrows-v fa-2x light-success-color clickable" aria-hidden="true" pTooltip="Swap Player1"
                 (click)="swapPlayerOne(roundMatch)">
              </i>
              <i *ngIf="playerToSwap && isOrga"
                 class="fa fa-times fa-2x light-fail-color clickable" aria-hidden="true" pTooltip="Stop Swapping"
                 (click)="stopSwapPlayer()">
              </i>
            </div>
            <div style="text-align: center" *ngIf="isOrga">
              <ng-container *ngFor="let chooseField of gameSystemConfig.choosePlayed">
                <p-dropdown *ngIf="chooseField.type === 'dropDown' && roundMatch.participantOne[chooseField.field]?.length > 0"
                            placeholder="Choose"
                            [(ngModel)]="roundMatch[chooseField.fieldPlayerOne]"
                            [options]="participantsChoosePlayedMap[roundMatch.participantOne.name]"
                            [autoWidth]="false"
                            (onChange)="saveChoosePlayed(roundMatch)"
                            [style]="{'width':'100%'}">
                </p-dropdown>
                <p-multiSelect *ngIf="chooseField.type === 'multiSelect' && roundMatch.participantOne[chooseField.field]?.length > 0"
                               placeholder="Choose"
                               [(ngModel)]="roundMatch[chooseField.fieldPlayerOne]"
                               [options]="participantsChoosePlayedMap[roundMatch.participantOne.name]"
                               (onPanelHide)="saveChoosePlayed(roundMatch)"
                               [showToggleAll]=false
                               [maxSelectedLabels]=3
                               [style]="{'width':'100%'}">
                </p-multiSelect>
              </ng-container>
            </div>
            <div style="text-align: center" *ngIf="!isOrga">
              <ng-container *ngFor="let chooseField of gameSystemConfig.choosePlayed">
                {{roundMatch[chooseField.fieldPlayerOne]}}
              </ng-container>
            </div>
          </ng-template>
        </p-column>
        <p-column styleClass="col-vs">
          <ng-template pTemplate="header"></ng-template>
          <ng-template pTemplate="body" let-roundMatch="rowData">
            <div style="text-align: center">
              <span class="big-text">VS</span>
            </div>
          </ng-template>
        </p-column>
        <p-column styleClass="col-player"
                  field="participantTwo.name"
                  header="Player 2"
                  [sortable]="true"
                  [filter]="true"
                  filterPlaceholder="Search">
          <ng-template pTemplate="filter" let-col let-roundMatch="rowData">
            <input type="text"
                   [(ngModel)]="participantTwoFilter"
                   pInputText
                   class="ui-column-filter"
                   (keyup)="filterParticipantTwoMatchesTable()"/>
          </ng-template>
          <ng-template pTemplate="body" let-roundMatch="rowData">
            <div style="text-align: center"
                 pTooltip="{{getToolTipForSwap(roundMatch, roundMatch.participantTwo, roundMatch.participantOne)}}"
                 (click)="dropPlayer(roundMatch, roundMatch.participantTwo, roundMatch.participantOne, 'two')"
                 [ngClass]="{
                     'swappable-player': (playerToSwap && checkSwap(roundMatch, roundMatch.participantTwo, roundMatch.participantOne) === 'swap'),
                     'not-intended-to-swap-player': (playerToSwap && checkSwap(roundMatch, roundMatch.participantTwo, roundMatch.participantOne) === 'not'),
                     'impossible-to-swap-player': (playerToSwap && checkSwap(roundMatch, roundMatch.participantTwo, roundMatch.participantOne) === 'impo'),
                     'winner-label': (roundMatch.scoreParticipantTwo === 1 && roundMatch.finished),
                     'looser-label': (roundMatch.scoreParticipantOne === 1 && roundMatch.finished),
                     'draw-label': (roundMatch.scoreParticipantOne === roundMatch.scoreParticipantTwo && roundMatch.finished)
                  }">

              <span class="very-big-text break-word" *ngIf="roundMatch.participantTwo.name !== 'bye'">
                    ({{getScoreTillRoundForParticipant(roundMatch.participantTwo)}})
                    {{roundMatch.participantTwo.name}}
              </span>
              <span class="very-big-text" *ngIf="roundMatch.participantTwo.name === 'bye'">BYE</span>
              <i *ngIf="!roundMatch?.finished && isOrga && !playerToSwap  && !tournamentFinished"
                 class="fa fa-arrows-v fa-2x light-success-color clickable" aria-hidden="true" pTooltip="Swap Player2"
                 (click)="swapPlayerTwo(roundMatch)">
              </i>
              <i *ngIf="playerToSwap && isOrga"
                 class="fa fa-times fa-2x light-fail-color clickable" aria-hidden="true" pTooltip="Stop Swapping"
                 (click)="stopSwapPlayer()">
              </i>
            </div>
            <div style="text-align: center" *ngIf="isOrga">
              <ng-container *ngFor="let chooseField of gameSystemConfig.choosePlayed">
                <p-dropdown *ngIf="chooseField.type === 'dropDown' && roundMatch.participantTwo[chooseField.field]?.length > 0"
                            placeholder="Choose"
                            [(ngModel)]="roundMatch[chooseField.fieldPlayerTwo]"
                            [options]="participantsChoosePlayedMap[roundMatch.participantTwo.name]"
                            [autoWidth]="false"
                            (onChange)="saveChoosePlayed(roundMatch)"
                            [style]="{'width':'100%'}">
                </p-dropdown>
                <p-multiSelect *ngIf="chooseField.type === 'multiSelect' && roundMatch.participantTwo[chooseField.field]?.length > 0"
                               placeholder="Choose"
                               [(ngModel)]="roundMatch[chooseField.fieldPlayerTwo]"
                               [options]="participantsChoosePlayedMap[roundMatch.participantTwo.name]"
                               (onPanelHide)="saveChoosePlayed(roundMatch)"
                               [showToggleAll]=false
                               [maxSelectedLabels]=3
                               [style]="{'width':'100%'}">
                </p-multiSelect>
              </ng-container>
            </div>
            <div style="text-align: center" *ngIf="!isOrga">
              <ng-container *ngFor="let chooseField of gameSystemConfig.choosePlayed">
                {{roundMatch[chooseField.fieldPlayerTwo]}}
              </ng-container>
            </div>
          </ng-template>
        </p-column>

        <ng-container *ngFor="let scoreField of gameSystemConfig.scoreFields">
          <p-column *ngIf="isOrga"
                    styleClass="col-scoring break-word">
            <ng-template pTemplate="header">
              {{scoreField.field}}
            </ng-template>
            <ng-template let-col let-roundMatch="rowData" pTemplate="body">
              <div>
                <input type="number" min="{{scoreField.min}}" max="{{scoreField.max}}" pInputText
                       [(ngModel)]="roundMatch[scoreField.fieldPlayerOne]"
                       size="50"
                       (blur)="changeScoringForPlayerOne(roundMatch, scoreField.field, roundMatch[scoreField.fieldPlayerOne])"
                       (keyup.enter)="forceBlurForScore($event)"
                />
                <span class="small-text"> {{scoreField.field}} {{roundMatch.participantOne.name}}</span>
              </div>
              <div class="breaking-line"></div>
              <div>
                <input type="number" min="{{scoreField.min}}" max="{{scoreField.max}}" pInputText
                       [(ngModel)]="roundMatch[scoreField.fieldPlayerTwo]"
                       size="50"
                       (blur)="changeScoringPlayerTwo(roundMatch, scoreField.field, roundMatch[scoreField.fieldPlayerTwo])"
                       (keyup.enter)="forceBlurForScore($event)"
                />
                <span class="small-text">{{scoreField.field}} {{roundMatch.participantTwo.name}}</span>
              </div>
            </ng-template>
          </p-column>
        </ng-container>
      </p-dataTable>
    </p-panel>
  </ng-container>
</ng-container>


